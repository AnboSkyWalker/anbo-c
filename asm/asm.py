#! /usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright Â© 2019 anbo <yelong@huawei.com>
#
# Distributed under terms of the MIT license.

import struct

# from undebuggable
# https://crackmes.one/crackme/5bc98bcc33c5d4110a29b2cc
def check2_code():
    buf = struct.pack ("160B", *[
        0xb4,0xe9,0xe9,0xe9,0xe9,0xe8,0x50,0xd8,0xa6,0xa5,0x59,
        0x24,0xa7,0xa6,0x5a,0x1f,0x9c,0x93,0x78,0x78,0x78,0x78,
        0x78,0xc0,0xc7,0xb3,0x72,0x4a,0xba,0xbb,0xbb,0x0d,0x02,
        0xd2,0xd3,0x9b,0x7b,0x3e,0xb5,0xfd,0x2d,0x4e,0x06,0xd6,
        0x5f,0x9d,0xb4,0xb7,0x55,0xd6,0x14,0x15,0x0b,0xe3,0x22,
        0x3d,0xc5,0x04,0xd4,0x5d,0x5c,0x0c,0x81,0x7d,0x38,0xb3,
        0x75,0xfc,0xfc,0x4a,0x45,0x95,0x94,0xdc,0x3c,0x79,0xf2,
        0xba,0x6a,0x09,0x41,0xbd,0xf8,0x73,0xb2,0x3b,0xf9,0x56,
        0x59,0x91,0x18,0xda,0x53,0x53,0xe5,0xea,0x3a,0x3b,0x73,
        0xab,0xee,0x65,0x2d,0xfd,0x9e,0xd6,0x2a,0x6f,0xe4,0x25,
        0xac,0xac,0x1a,0x15,0xc5,0xc4,0x8c,0x64,0x21,0xaa,0xe2,
        0x32,0x51,0x19,0xe5,0xa0,0x2b,0x59,0xb2,0xb2,0xb2,0xb2,
        0xb2,0x4e,0x0b,0xcc,0x14,0x41,0xc8,0x80,0x60,0x15,0x9c,
        0xd4,0x3c,0x41,0xc8,0x80,0x65,0xec,0xa4,0xf1,0x00,0x00,
        0x00,0x00,0x00,0x00,0x00,0x00
    ])

    v1 = 199
    v3 = [None]*0x98
    for i in xrange(0x98):
        a = ord(buf[i])
        v3[152-i-1] = chr(v1 ^ a)
        v1 = a
    v3 = ''.join(v3)
    with open("./check2_code", "wb") as fd:
        fd.write(v3)



if __name__ == "__main__":
    check2_code()

